<% if @level == 'null' %>//level je parent_id z params
  
$("div[id^='group-<%= params[:type] %>'] .listFilter").append("<%= escape_javascript(render(:partial => 'header')) %>");
$("div[id^='group-<%= params[:type] %>'] .listContent").append("<%= escape_javascript(render(:partial => 'albums', :object => @albums)) %>");

//map forms
$("li a[class^='newLeaf-']").bind("click", function() { return newLeaf( $(this).attr("class").split("-")[1] ) });
$("li a.newAtt").bind("click", function() { return newAtt( '<%= params[:type] %>' ) });  

<% else %>


<% if params[:type] == 'image' %>
  <% prom = @album.pictures.size  %>
<% elsif params[:type] == 'inset'  %>
  <% prom = @album.insets.size %>
<% elsif params[:type] == 'audio'  %>
  <% prom = @album.audios.size %>
<% end  %>


<% if @albums.size > 0 %>//obsahuje podvetve a mozna obrazky
  
$("div[id^='group-<%= params[:type] %>'] tr[id='level-<%= @tree %>']").after("<%= escape_javascript(render(:partial => 'leafs', :object => @albums)) %>");
//files ze stromu o level vys
<% if @albums.first.child? %>

$("tr[id='level-<%= @tree %>-<%= @albums.size %>']").after("<%= escape_javascript(render(:partial => params[:type], :object => @albums.first.parent)) %>");

<% end %>
//$("tr[id^=editPictxxx] a").bind("click", function() { return editImage("tr[id^=editPict"].attr("class") ) });



  
<% elsif prom > 0 %>//neobsahuje podvetve, pouze obrazky 


$("tr[id='level-<%= @tree %>']").after("<%= escape_javascript(render(:partial => params[:type], :object => @album)) %>");  

<% end %>

$("td.listItem a").unbind();

<% end %>